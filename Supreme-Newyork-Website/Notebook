{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import requests\n",
    "import sqlite3\n",
    "import json \n",
    "import pandas as pd \n",
    "from pandas.io.json import json_normalize\n",
    "\n",
    "response = requests.get(\"https://www.supremenewyork.com/mobile_stock.json\")\n",
    "\n",
    "response_list = json.loads(response.text)\n",
    "\n",
    "date = response_list[\"release_date\"]\n",
    "release_week = response_list[\"release_week\"]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dict_keys(['unique_image_url_prefixes', 'products_and_categories', 'release_date', 'release_week'])"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "response_list.keys()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Jackets</th>\n",
       "      <th>Shirts</th>\n",
       "      <th>Pants</th>\n",
       "      <th>Sweatshirts</th>\n",
       "      <th>Tops/Sweaters</th>\n",
       "      <th>Hats</th>\n",
       "      <th>Bags</th>\n",
       "      <th>Accessories</th>\n",
       "      <th>Skate</th>\n",
       "      <th>new</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>[{'name': 'Supreme®/Ben Davis Chore Coat', 'id...</td>\n",
       "      <td>[{'name': 'Supreme®/Ben Davis Half Zip Work Sh...</td>\n",
       "      <td>[{'name': 'Supreme®/Ben Davis Overalls ', 'id'...</td>\n",
       "      <td>[{'name': 'Nose Bleed Hooded Sweatshirt', 'id'...</td>\n",
       "      <td>[{'name': 'Hearts Dyed S/S Top', 'id': 6164, '...</td>\n",
       "      <td>[{'name': 'Mary 5-Panel', 'id': 6165, 'image_u...</td>\n",
       "      <td>[{'name': 'Duffle Bag', 'id': 6105, 'image_url...</td>\n",
       "      <td>[{'name': 'Supreme®/Butterfly Table Tennis Rac...</td>\n",
       "      <td>[{'name': 'Disturbed Skateboard', 'id': 6113, ...</td>\n",
       "      <td>[{'name': 'Supreme®/Ben Davis Chore Coat', 'id...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                             Jackets  \\\n",
       "0  [{'name': 'Supreme®/Ben Davis Chore Coat', 'id...   \n",
       "\n",
       "                                              Shirts  \\\n",
       "0  [{'name': 'Supreme®/Ben Davis Half Zip Work Sh...   \n",
       "\n",
       "                                               Pants  \\\n",
       "0  [{'name': 'Supreme®/Ben Davis Overalls ', 'id'...   \n",
       "\n",
       "                                         Sweatshirts  \\\n",
       "0  [{'name': 'Nose Bleed Hooded Sweatshirt', 'id'...   \n",
       "\n",
       "                                       Tops/Sweaters  \\\n",
       "0  [{'name': 'Hearts Dyed S/S Top', 'id': 6164, '...   \n",
       "\n",
       "                                                Hats  \\\n",
       "0  [{'name': 'Mary 5-Panel', 'id': 6165, 'image_u...   \n",
       "\n",
       "                                                Bags  \\\n",
       "0  [{'name': 'Duffle Bag', 'id': 6105, 'image_url...   \n",
       "\n",
       "                                         Accessories  \\\n",
       "0  [{'name': 'Supreme®/Butterfly Table Tennis Rac...   \n",
       "\n",
       "                                               Skate  \\\n",
       "0  [{'name': 'Disturbed Skateboard', 'id': 6113, ...   \n",
       "\n",
       "                                                 new  \n",
       "0  [{'name': 'Supreme®/Ben Davis Chore Coat', 'id...  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Temp_Frame = json_normalize(response_list[\"products_and_categories\"])\n",
    "Temp_Frame"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Jackets', 'Shirts', 'Pants', 'Sweatshirts', 'Tops/Sweaters', 'Hats',\n",
       "       'Bags', 'Accessories', 'Skate', 'new'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Column_Names = Temp_Frame.columns\n",
    "Column_Names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shirts\n",
      "------\n",
      "Pants\n",
      "------\n",
      "Sweatshirts\n",
      "------\n",
      "Tops/Sweaters\n",
      "------\n",
      "Hats\n",
      "------\n",
      "Bags\n",
      "------\n",
      "Accessories\n",
      "------\n",
      "Skate\n",
      "------\n",
      "new\n",
      "------\n"
     ]
    }
   ],
   "source": [
    "Main_Frame = json_normalize(Temp_Frame[Column_Names[0]][0])\n",
    "\n",
    "for names in Column_Names[1:]:\n",
    "    print(names)\n",
    "    print(\"------\")\n",
    "    Frame = json_normalize(Temp_Frame[names][0])\n",
    "    Main_Frame = Main_Frame.append(Frame)\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>id</th>\n",
       "      <th>price</th>\n",
       "      <th>sale_price</th>\n",
       "      <th>new_item</th>\n",
       "      <th>position</th>\n",
       "      <th>category_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Supreme®/Ben Davis Chore Coat</td>\n",
       "      <td>6172</td>\n",
       "      <td>2700000</td>\n",
       "      <td>0</td>\n",
       "      <td>True</td>\n",
       "      <td>0</td>\n",
       "      <td>Jackets</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Mug Shot Crew Jacket</td>\n",
       "      <td>6155</td>\n",
       "      <td>3132000</td>\n",
       "      <td>0</td>\n",
       "      <td>True</td>\n",
       "      <td>3</td>\n",
       "      <td>Jackets</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Reversible Bandana Fleece Jacket</td>\n",
       "      <td>6154</td>\n",
       "      <td>3456000</td>\n",
       "      <td>0</td>\n",
       "      <td>True</td>\n",
       "      <td>4</td>\n",
       "      <td>Jackets</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>GORE-TEX Overcoat</td>\n",
       "      <td>6067</td>\n",
       "      <td>5832000</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>5</td>\n",
       "      <td>Jackets</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>GORE-TEX Taped Seam Jacket</td>\n",
       "      <td>6068</td>\n",
       "      <td>6372000</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>6</td>\n",
       "      <td>Jackets</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>17</td>\n",
       "      <td>Supreme®/Ben Davis Beanie</td>\n",
       "      <td>6171</td>\n",
       "      <td>540000</td>\n",
       "      <td>0</td>\n",
       "      <td>True</td>\n",
       "      <td>30</td>\n",
       "      <td>Hats</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>18</td>\n",
       "      <td>New Era® Script Cuff Beanie</td>\n",
       "      <td>6167</td>\n",
       "      <td>594000</td>\n",
       "      <td>0</td>\n",
       "      <td>True</td>\n",
       "      <td>31</td>\n",
       "      <td>Hats</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>19</td>\n",
       "      <td>Supreme®/Butterfly Table Tennis Racket Set</td>\n",
       "      <td>6168</td>\n",
       "      <td>2916000</td>\n",
       "      <td>0</td>\n",
       "      <td>True</td>\n",
       "      <td>38</td>\n",
       "      <td>Accessories</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>20</td>\n",
       "      <td>Supreme®/Post-it® Flags</td>\n",
       "      <td>6170</td>\n",
       "      <td>151200</td>\n",
       "      <td>0</td>\n",
       "      <td>True</td>\n",
       "      <td>39</td>\n",
       "      <td>Accessories</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>21</td>\n",
       "      <td>Supreme®/NITECORE® Tini Keychain Light</td>\n",
       "      <td>6169</td>\n",
       "      <td>810000</td>\n",
       "      <td>0</td>\n",
       "      <td>True</td>\n",
       "      <td>40</td>\n",
       "      <td>Accessories</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>71 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                          name    id    price  sale_price  \\\n",
       "0                Supreme®/Ben Davis Chore Coat  6172  2700000           0   \n",
       "1                         Mug Shot Crew Jacket  6155  3132000           0   \n",
       "2            Reversible Bandana Fleece Jacket   6154  3456000           0   \n",
       "3                            GORE-TEX Overcoat  6067  5832000           0   \n",
       "4                   GORE-TEX Taped Seam Jacket  6068  6372000           0   \n",
       "..                                         ...   ...      ...         ...   \n",
       "17                   Supreme®/Ben Davis Beanie  6171   540000           0   \n",
       "18                 New Era® Script Cuff Beanie  6167   594000           0   \n",
       "19  Supreme®/Butterfly Table Tennis Racket Set  6168  2916000           0   \n",
       "20                     Supreme®/Post-it® Flags  6170   151200           0   \n",
       "21      Supreme®/NITECORE® Tini Keychain Light  6169   810000           0   \n",
       "\n",
       "    new_item  position category_name  \n",
       "0       True         0       Jackets  \n",
       "1       True         3       Jackets  \n",
       "2       True         4       Jackets  \n",
       "3      False         5       Jackets  \n",
       "4      False         6       Jackets  \n",
       "..       ...       ...           ...  \n",
       "17      True        30          Hats  \n",
       "18      True        31          Hats  \n",
       "19      True        38   Accessories  \n",
       "20      True        39   Accessories  \n",
       "21      True        40   Accessories  \n",
       "\n",
       "[71 rows x 7 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Main_Frame = Main_Frame.drop([\"image_url\",\"image_url_hi\"],axis=1)\n",
    "Main_Frame"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Success at 6155\n",
      "Success at 6154\n",
      "Success at 6067\n",
      "Success at 6068\n",
      "Success at 6137\n",
      "Success at 6175\n",
      "Success at 6156\n",
      "Success at 6174\n",
      "Success at 6173\n",
      "Success at 6157\n",
      "Success at 6158\n",
      "Success at 6076\n",
      "Success at 6080\n",
      "Success at 6077\n",
      "Success at 6078\n",
      "Success at 6083\n",
      "Success at 6081\n",
      "Success at 6160\n",
      "Success at 6161\n",
      "Success at 6159\n",
      "Success at 6146\n",
      "Success at 6164\n",
      "Success at 6162\n",
      "Success at 6163\n",
      "Success at 6149\n",
      "Success at 6147\n",
      "Success at 6148\n",
      "Success at 6165\n",
      "Success at 6166\n",
      "Success at 6171\n",
      "Success at 6167\n",
      "Success at 6150\n",
      "Success at 6102\n",
      "Success at 6105\n",
      "Success at 6103\n",
      "Success at 6108\n",
      "Success at 6104\n",
      "Success at 6106\n",
      "Success at 6168\n",
      "Success at 6170\n",
      "Success at 6169\n",
      "Success at 6110\n",
      "Success at 6133\n",
      "Success at 6134\n",
      "Success at 6135\n",
      "Success at 6113\n",
      "Success at 6132\n",
      "Success at 6131\n"
     ]
    }
   ],
   "source": [
    "SUB_MASTER_DATAFRAME = []\n",
    "\n",
    "All_IDS = Main_Frame[\"id\"].unique()\n",
    "\n",
    "response = requests.get(\"https://www.supremenewyork.com/shop/\"+str(All_IDS[0])+\".json\")\n",
    "response_list = json.loads(response.text)\n",
    "\n",
    "Temp_Frame = json_normalize(response_list)\n",
    "Second_Temp_Frame = json_normalize(Temp_Frame[\"styles\"][0])\n",
    "\n",
    "Third_Temp_Frame = json_normalize(Second_Temp_Frame[\"sizes\"][0])\n",
    "Third_Temp_Frame.columns = [\"name\",\"main_id\",\"stock_level\"]\n",
    "\n",
    "Fourth_Data_Frame = pd.DataFrame(index=range(len(Third_Temp_Frame)),columns=range(len(Second_Temp_Frame.iloc[0])-2))\n",
    "\n",
    "for row_number in range(len(Second_Temp_Frame.iloc[0])-2):\n",
    "    Fourth_Data_Frame[row_number] = Second_Temp_Frame.iloc[0][row_number]\n",
    "\n",
    "Fourth_Data_Frame.columns = list(Second_Temp_Frame.columns)[:-2]\n",
    "\n",
    "ALL_DATA_FRAME = pd.concat([Third_Temp_Frame, Fourth_Data_Frame], axis=1, sort=False)\n",
    "\n",
    "for size in range(1,len(Second_Temp_Frame[\"sizes\"])):\n",
    "    \n",
    "    Third_Temp_Frame = json_normalize(Second_Temp_Frame[\"sizes\"][size])\n",
    "    \n",
    "    Third_Temp_Frame.columns = [\"name\",\"main_id\",\"stock_level\"]\n",
    "    \n",
    "    Fourth_Data_Frame = pd.DataFrame(index=range(len(Third_Temp_Frame)),columns=range(len(Second_Temp_Frame.iloc[size])-2))\n",
    "\n",
    "    for row_number in range(len(Second_Temp_Frame.iloc[size])-2):\n",
    "        Fourth_Data_Frame[row_number] = Second_Temp_Frame.iloc[size][row_number]\n",
    "    \n",
    "    Fourth_Data_Frame.columns = list(Second_Temp_Frame.columns)[:-2]\n",
    "\n",
    "    Fourth_Data_Frame = pd.concat([Third_Temp_Frame, Fourth_Data_Frame], axis=1, sort=False)\n",
    "    \n",
    "    ALL_DATA_FRAME = ALL_DATA_FRAME.append(Fourth_Data_Frame)\n",
    "    \n",
    "ALL_DATA_FRAME = ALL_DATA_FRAME.drop([\"description\",\"image_url\",\"swatch_url\",\"mobile_zoomed_url\",\"mobile_zoomed_url_hi\",\"bigger_zoomed_url\"],axis=1)\n",
    "\n",
    "for names in list(Temp_Frame.columns)[1:]:\n",
    "    ALL_DATA_FRAME[names] = Temp_Frame[names][0]\n",
    "    \n",
    "ALL_DATA_FRAME = ALL_DATA_FRAME.reset_index(drop=True)  \n",
    "ALL_DATA_FRAME[\"product_id\"] = All_IDS[0]\n",
    "                        \n",
    "SUB_MASTER_DATAFRAME = ALL_DATA_FRAME\n",
    "\n",
    "\n",
    "##########################################################\n",
    "                        \n",
    "for product_scrape_id in All_IDS[1:]:\n",
    "    \n",
    "    try:\n",
    "        \n",
    "        response = requests.get(\"https://www.supremenewyork.com/shop/\"+str(product_scrape_id)+\".json\")\n",
    "        response_list = json.loads(response.text)\n",
    "        Temp_Frame = json_normalize(response_list)\n",
    "        Second_Temp_Frame = json_normalize(Temp_Frame[\"styles\"][0])\n",
    "        Third_Temp_Frame = json_normalize(Second_Temp_Frame[\"sizes\"][0])\n",
    "        Third_Temp_Frame.columns = [\"name\",\"main_id\",\"stock_level\"]\n",
    "        Fourth_Data_Frame = pd.DataFrame(index=range(len(Third_Temp_Frame)),columns=range(len(Second_Temp_Frame.iloc[0])-2))\n",
    "\n",
    "\n",
    "        for row_number in range(len(Second_Temp_Frame.iloc[0])-2):\n",
    "            Fourth_Data_Frame[row_number] = Second_Temp_Frame.iloc[0][row_number]\n",
    "\n",
    "        Fourth_Data_Frame.columns = list(Second_Temp_Frame.columns)[:-2]\n",
    "\n",
    "        ALL_DATA_FRAME = pd.concat([Third_Temp_Frame, Fourth_Data_Frame], axis=1, sort=False)\n",
    "\n",
    "\n",
    "        for size in range(1,len(Second_Temp_Frame[\"sizes\"])):\n",
    "\n",
    "            Third_Temp_Frame = json_normalize(Second_Temp_Frame[\"sizes\"][size])\n",
    "\n",
    "            Third_Temp_Frame.columns = [\"name\",\"main_id\",\"stock_level\"]\n",
    "\n",
    "            Fourth_Data_Frame = pd.DataFrame(index=range(len(Third_Temp_Frame)),columns=range(len(Second_Temp_Frame.iloc[size])-2))\n",
    "\n",
    "            for row_number in range(len(Second_Temp_Frame.iloc[size])-2):\n",
    "                Fourth_Data_Frame[row_number] = Second_Temp_Frame.iloc[size][row_number]\n",
    "\n",
    "            Fourth_Data_Frame.columns = list(Second_Temp_Frame.columns)[:-2]\n",
    "\n",
    "            Fourth_Data_Frame = pd.concat([Third_Temp_Frame, Fourth_Data_Frame], axis=1, sort=False)\n",
    "\n",
    "            ALL_DATA_FRAME = ALL_DATA_FRAME.append(Fourth_Data_Frame)\n",
    "\n",
    "        ALL_DATA_FRAME = ALL_DATA_FRAME.drop([\"description\",\"image_url\",\"swatch_url\",\"mobile_zoomed_url\",\"mobile_zoomed_url_hi\",\"bigger_zoomed_url\"],axis=1)\n",
    "\n",
    "        for names in list(Temp_Frame.columns)[1:]:\n",
    "            ALL_DATA_FRAME[names] = Temp_Frame[names][0]\n",
    "\n",
    "        ALL_DATA_FRAME = ALL_DATA_FRAME.reset_index(drop=True)\n",
    "        ALL_DATA_FRAME[\"product_id\"] = product_scrape_id\n",
    "\n",
    "\n",
    "        SUB_MASTER_DATAFRAME = SUB_MASTER_DATAFRAME.append(ALL_DATA_FRAME)\n",
    "        \n",
    "        print(\"Success at \" + str(product_scrape_id))\n",
    "        \n",
    "    except:\n",
    "        print(\"Failed at \"+str(product_scrape_id))\n",
    "\n",
    "\n",
    "                        "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['name', 'id', 'price', 'sale_price', 'new_item', 'position',\n",
       "       'category_name'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Main_Frame.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['name', 'main_id', 'stock_level', 'id', 'name', 'currency',\n",
       "       'image_url_hi', 'swatch_url_hi', 'description', 'can_add_styles',\n",
       "       'can_buy_multiple', 'ino', 'cod_blocked', 'canada_blocked',\n",
       "       'purchasable_qty', 'new_item', 'apparel', 'handling',\n",
       "       'no_free_shipping', 'can_buy_multiple_with_limit', 'product_id'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "SUB_MASTER_DATAFRAME.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "SUB_MASTER_DATAFRAME.columns = [\"size\",\"product_id\",\"stock_level\",\"main_id\",\"color\",\"currency\",\n",
    "                               'image_url_hi', 'swatch_url_hi', 'description', 'can_add_styles',\n",
    "                               'can_buy_multiple', 'ino', 'cod_blocked', 'canada_blocked',\n",
    "                               'purchasable_qty', 'new_item', 'apparel', 'handling',\n",
    "                               'no_free_shipping', 'can_buy_multiple_with_limit',\"id\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>size</th>\n",
       "      <th>product_id</th>\n",
       "      <th>stock_level</th>\n",
       "      <th>main_id</th>\n",
       "      <th>color</th>\n",
       "      <th>currency</th>\n",
       "      <th>image_url_hi</th>\n",
       "      <th>swatch_url_hi</th>\n",
       "      <th>description</th>\n",
       "      <th>can_add_styles</th>\n",
       "      <th>...</th>\n",
       "      <th>ino</th>\n",
       "      <th>cod_blocked</th>\n",
       "      <th>canada_blocked</th>\n",
       "      <th>purchasable_qty</th>\n",
       "      <th>new_item</th>\n",
       "      <th>apparel</th>\n",
       "      <th>handling</th>\n",
       "      <th>no_free_shipping</th>\n",
       "      <th>can_buy_multiple_with_limit</th>\n",
       "      <th>id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Small</td>\n",
       "      <td>68164</td>\n",
       "      <td>0</td>\n",
       "      <td>23803</td>\n",
       "      <td>Navy</td>\n",
       "      <td>JPY</td>\n",
       "      <td>//assets.supremenewyork.com/178977/rs/RjnHZ_8r...</td>\n",
       "      <td>//assets.supremenewyork.com/178977/rc/RjnHZ_8r...</td>\n",
       "      <td>Heavy cotton blend twill with snap front closu...</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>FW19J94</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>6172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Medium</td>\n",
       "      <td>68165</td>\n",
       "      <td>0</td>\n",
       "      <td>23803</td>\n",
       "      <td>Navy</td>\n",
       "      <td>JPY</td>\n",
       "      <td>//assets.supremenewyork.com/178977/rs/RjnHZ_8r...</td>\n",
       "      <td>//assets.supremenewyork.com/178977/rc/RjnHZ_8r...</td>\n",
       "      <td>Heavy cotton blend twill with snap front closu...</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>FW19J94</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>6172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Large</td>\n",
       "      <td>68166</td>\n",
       "      <td>0</td>\n",
       "      <td>23803</td>\n",
       "      <td>Navy</td>\n",
       "      <td>JPY</td>\n",
       "      <td>//assets.supremenewyork.com/178977/rs/RjnHZ_8r...</td>\n",
       "      <td>//assets.supremenewyork.com/178977/rc/RjnHZ_8r...</td>\n",
       "      <td>Heavy cotton blend twill with snap front closu...</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>FW19J94</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>6172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>XLarge</td>\n",
       "      <td>68167</td>\n",
       "      <td>0</td>\n",
       "      <td>23803</td>\n",
       "      <td>Navy</td>\n",
       "      <td>JPY</td>\n",
       "      <td>//assets.supremenewyork.com/178977/rs/RjnHZ_8r...</td>\n",
       "      <td>//assets.supremenewyork.com/178977/rc/RjnHZ_8r...</td>\n",
       "      <td>Heavy cotton blend twill with snap front closu...</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>FW19J94</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>6172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Small</td>\n",
       "      <td>68168</td>\n",
       "      <td>0</td>\n",
       "      <td>23804</td>\n",
       "      <td>Hickory Stripe</td>\n",
       "      <td>JPY</td>\n",
       "      <td>//assets.supremenewyork.com/178980/rs/3p_ClGKR...</td>\n",
       "      <td>//assets.supremenewyork.com/178980/rc/3p_ClGKR...</td>\n",
       "      <td>Heavy cotton blend twill with snap front closu...</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>FW19J94</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>6172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>139</td>\n",
       "      <td>67878</td>\n",
       "      <td>1</td>\n",
       "      <td>23642</td>\n",
       "      <td>Silver</td>\n",
       "      <td>JPY</td>\n",
       "      <td>//assets.supremenewyork.com/178720/rs/zv_hGJQo...</td>\n",
       "      <td>//assets.supremenewyork.com/178720/rc/zv_hGJQo...</td>\n",
       "      <td>Classic Independent® truck with custom Supreme...</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>FW19A90A</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>6132</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>149</td>\n",
       "      <td>67879</td>\n",
       "      <td>1</td>\n",
       "      <td>23642</td>\n",
       "      <td>Silver</td>\n",
       "      <td>JPY</td>\n",
       "      <td>//assets.supremenewyork.com/178720/rs/zv_hGJQo...</td>\n",
       "      <td>//assets.supremenewyork.com/178720/rc/zv_hGJQo...</td>\n",
       "      <td>Classic Independent® truck with custom Supreme...</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>FW19A90A</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>6132</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>N/A</td>\n",
       "      <td>67875</td>\n",
       "      <td>1</td>\n",
       "      <td>23639</td>\n",
       "      <td>Red 51MM</td>\n",
       "      <td>JPY</td>\n",
       "      <td>//assets.supremenewyork.com/178717/rs/5SR1ZchA...</td>\n",
       "      <td>//assets.supremenewyork.com/178717/rc/5SR1ZchA...</td>\n",
       "      <td>Classic Spitfire® wheels with custom Supreme a...</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>FW19A81</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>6131</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>N/A</td>\n",
       "      <td>67876</td>\n",
       "      <td>0</td>\n",
       "      <td>23640</td>\n",
       "      <td>Gold 58MM</td>\n",
       "      <td>JPY</td>\n",
       "      <td>//assets.supremenewyork.com/178718/rs/ZCt1H1ed...</td>\n",
       "      <td>//assets.supremenewyork.com/178718/rc/ZCt1H1ed...</td>\n",
       "      <td>Classic Spitfire® wheels with custom Supreme a...</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>FW19A81</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>6131</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>N/A</td>\n",
       "      <td>67877</td>\n",
       "      <td>1</td>\n",
       "      <td>23641</td>\n",
       "      <td>White 53MM</td>\n",
       "      <td>JPY</td>\n",
       "      <td>//assets.supremenewyork.com/178716/rs/ynmkyk96...</td>\n",
       "      <td>//assets.supremenewyork.com/178716/rc/ynmkyk96...</td>\n",
       "      <td>Classic Spitfire® wheels with custom Supreme a...</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>FW19A81</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>0</td>\n",
       "      <td>6131</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>530 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      size  product_id  stock_level  main_id           color currency  \\\n",
       "0    Small       68164            0    23803            Navy      JPY   \n",
       "1   Medium       68165            0    23803            Navy      JPY   \n",
       "2    Large       68166            0    23803            Navy      JPY   \n",
       "3   XLarge       68167            0    23803            Navy      JPY   \n",
       "4    Small       68168            0    23804  Hickory Stripe      JPY   \n",
       "..     ...         ...          ...      ...             ...      ...   \n",
       "1      139       67878            1    23642          Silver      JPY   \n",
       "2      149       67879            1    23642          Silver      JPY   \n",
       "0      N/A       67875            1    23639        Red 51MM      JPY   \n",
       "1      N/A       67876            0    23640       Gold 58MM      JPY   \n",
       "2      N/A       67877            1    23641      White 53MM      JPY   \n",
       "\n",
       "                                         image_url_hi  \\\n",
       "0   //assets.supremenewyork.com/178977/rs/RjnHZ_8r...   \n",
       "1   //assets.supremenewyork.com/178977/rs/RjnHZ_8r...   \n",
       "2   //assets.supremenewyork.com/178977/rs/RjnHZ_8r...   \n",
       "3   //assets.supremenewyork.com/178977/rs/RjnHZ_8r...   \n",
       "4   //assets.supremenewyork.com/178980/rs/3p_ClGKR...   \n",
       "..                                                ...   \n",
       "1   //assets.supremenewyork.com/178720/rs/zv_hGJQo...   \n",
       "2   //assets.supremenewyork.com/178720/rs/zv_hGJQo...   \n",
       "0   //assets.supremenewyork.com/178717/rs/5SR1ZchA...   \n",
       "1   //assets.supremenewyork.com/178718/rs/ZCt1H1ed...   \n",
       "2   //assets.supremenewyork.com/178716/rs/ynmkyk96...   \n",
       "\n",
       "                                        swatch_url_hi  \\\n",
       "0   //assets.supremenewyork.com/178977/rc/RjnHZ_8r...   \n",
       "1   //assets.supremenewyork.com/178977/rc/RjnHZ_8r...   \n",
       "2   //assets.supremenewyork.com/178977/rc/RjnHZ_8r...   \n",
       "3   //assets.supremenewyork.com/178977/rc/RjnHZ_8r...   \n",
       "4   //assets.supremenewyork.com/178980/rc/3p_ClGKR...   \n",
       "..                                                ...   \n",
       "1   //assets.supremenewyork.com/178720/rc/zv_hGJQo...   \n",
       "2   //assets.supremenewyork.com/178720/rc/zv_hGJQo...   \n",
       "0   //assets.supremenewyork.com/178717/rc/5SR1ZchA...   \n",
       "1   //assets.supremenewyork.com/178718/rc/ZCt1H1ed...   \n",
       "2   //assets.supremenewyork.com/178716/rc/ynmkyk96...   \n",
       "\n",
       "                                          description  can_add_styles  ...  \\\n",
       "0   Heavy cotton blend twill with snap front closu...           False  ...   \n",
       "1   Heavy cotton blend twill with snap front closu...           False  ...   \n",
       "2   Heavy cotton blend twill with snap front closu...           False  ...   \n",
       "3   Heavy cotton blend twill with snap front closu...           False  ...   \n",
       "4   Heavy cotton blend twill with snap front closu...           False  ...   \n",
       "..                                                ...             ...  ...   \n",
       "1   Classic Independent® truck with custom Supreme...           False  ...   \n",
       "2   Classic Independent® truck with custom Supreme...           False  ...   \n",
       "0   Classic Spitfire® wheels with custom Supreme a...           False  ...   \n",
       "1   Classic Spitfire® wheels with custom Supreme a...           False  ...   \n",
       "2   Classic Spitfire® wheels with custom Supreme a...           False  ...   \n",
       "\n",
       "         ino cod_blocked  canada_blocked  purchasable_qty  new_item  apparel  \\\n",
       "0    FW19J94        True           False                1      True     True   \n",
       "1    FW19J94        True           False                1      True     True   \n",
       "2    FW19J94        True           False                1      True     True   \n",
       "3    FW19J94        True           False                1      True     True   \n",
       "4    FW19J94        True           False                1      True     True   \n",
       "..       ...         ...             ...              ...       ...      ...   \n",
       "1   FW19A90A       False           False                1     False    False   \n",
       "2   FW19A90A       False           False                1     False    False   \n",
       "0    FW19A81       False           False                1     False    False   \n",
       "1    FW19A81       False           False                1     False    False   \n",
       "2    FW19A81       False           False                1     False    False   \n",
       "\n",
       "    handling  no_free_shipping  can_buy_multiple_with_limit    id  \n",
       "0          0             False                            0  6172  \n",
       "1          0             False                            0  6172  \n",
       "2          0             False                            0  6172  \n",
       "3          0             False                            0  6172  \n",
       "4          0             False                            0  6172  \n",
       "..       ...               ...                          ...   ...  \n",
       "1          0             False                            0  6132  \n",
       "2          0             False                            0  6132  \n",
       "0          0             False                            0  6131  \n",
       "1          0             False                            0  6131  \n",
       "2          0             False                            0  6131  \n",
       "\n",
       "[530 rows x 21 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "SUB_MASTER_DATAFRAME"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "Final_Data_Frame = pd.merge(Main_Frame,SUB_MASTER_DATAFRAME, on =\"id\")\n",
    "\n",
    "Final_Data_Frame[\"date\"] = date\n",
    "Final_Data_Frame[\"release_week\"] = release_week\n",
    "\n",
    "writer = pd.ExcelWriter('Supreme_Products.xlsx', engine='xlsxwriter')\n",
    "Final_Data_Frame.to_excel(writer, sheet_name='Sheet1')\n",
    "\n",
    "writer.save()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
